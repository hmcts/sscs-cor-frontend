{% from "radios/macro.njk" import govukRadios %}
{% from "button/macro.njk" import govukButton %}
{% from "components/error-summary/macro.njk" import govukErrorSummary %}
{% extends "layout.html" %}
{% set pageHeader = content.en.tribunalView.header %}
{% block corContent %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {% if error %}
        {{ govukErrorSummary({
          titleText: content.en.errorSummary.titleText,
          descriptionText: content.en.errorSummary.descriptionText,
          errorList: [{
            text: error,
            href: "#accept-view-1"
          }]
        }) }}
      {% endif %}

      <h1 class="govuk-heading-l">{{ content.en.tribunalView.header }}</h1>
      {% include "includes/appellant-details.html" %}
    </div>
  </div>

  {% include "includes/divider.html" %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div id="decision">
        <div id="decision-outcome" class="panel-blue">
          <p>
            {% if endDate %}
            {{ content.en.tribunalView.decision.viewEntitledTo | eval | date }}</p>
            {% else %}
              {{ content.en.tribunalView.decision.viewEntitledToIndefinite | eval | date }}</p>
            {% endif %}
          <table class="govuk-table">
            <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <th class="govuk-table__cell">
                {{ content.en.tribunalView.decision.dailyLiving }}
              </th>
              <td class="govuk-table__cell">
                {{ content.en.tribunalView.decision.rate[decision.decision_rates.daily_living] }}
              </td>
            </tr>
            <tr class="govuk-table__row">
              <th class="govuk-table__cell">
                {{ content.en.tribunalView.decision.mobility }}
              </th>
              <td class="govuk-table__cell">
                {{ content.en.tribunalView.decision.rate[decision.decision_rates.mobility] }}
              </td>
            </tr>
            </tbody>
          </table>
          <p>{{ content.en.tribunalView.decision.dwp[decision.decision_rates.compared_to_dwp] }}</p>
        </div>
        <p class="govuk-inset-text">{{ content.en.tribunalView.decision.confirmAccept }}</p>
        <div id="decision-reason">
          <h2 class="govuk-heading-m">{{ content.en.tribunalView.reasonsHeader }}</h2>
          <p id="decision-text">{{ decision.reason }}</p>
        </div>
      </div>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="decision-activities">
      <div>
        <details class="govuk-details">
          <summary class="govuk-details__summary">
            <span class="govuk-details__summary-text">
              {{ content.en.tribunalView.activitiesSummary }}
            </span>
          </summary>
          <div class="govuk-details__text">

            <h2 class="govuk-heading-m">{{ content.en.tribunalView.dailyLivingActivitiesHeader }}</h2>
            <table class="govuk-table">
              <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th class="govuk-table__header col-1" >{{ content.en.tribunalView.activitiesTable.headerActivity }}</th>
                <th class="govuk-table__header col-2" >{{ content.en.tribunalView.activitiesTable.headerDescriptor }}</th>
                <th class="govuk-table__header col-3" >{{ content.en.tribunalView.activitiesTable.headerPoints }}</th>
              </tr>
              </thead>
              <tbody class="govuk-table__body">
              {% if decision.activities.daily_living %}
                {% for activity in decision.activities.daily_living %}
                  <tr class="govuk-table__row">
                    <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.dailyLiving[activity.activity].name }}</td>
                    <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.dailyLiving[activity.activity].scores[activity.selection_key].text | safe }}</td>
                    <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.dailyLiving[activity.activity].scores[activity.selection_key].score }}</td>
                  </tr>
                {% endfor %}
              {% else %}
              <tr class="govuk-table__row">
                <td class="govuk-table__cell align--top" colspan="3">
                  {{ content.en.tribunalView.dailyLivingActivitiesHeaderEmpty }}
                </td>
              </tr>
              {% endif %}
              </tbody>
            </table>
            <br />
            <h2 class="govuk-heading-m">{{ content.en.tribunalView.mobilityActivitiesHeader }}</h2>
            <table class="govuk-table">
              <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th class="govuk-table__header col-1" >{{ content.en.tribunalView.activitiesTable.headerActivity }}</th>
                <th class="govuk-table__header col-2" >{{ content.en.tribunalView.activitiesTable.headerDescriptor }}</th>
                <th class="govuk-table__header col-3" >{{ content.en.tribunalView.activitiesTable.headerPoints }}</th>
              </tr>
              </thead>
              <tbody class="govuk-table__body">
              {% if decision.activities.mobility %}
                {% for activity in decision.activities.mobility %}
                <tr class="govuk-table__row">
                  <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.mobility[activity.activity].name }}</td>
                  <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.mobility[activity.activity].scores[activity.selection_key].text | safe }}</td>
                  <td class="govuk-table__cell align--top">{{ content.en.tribunalView.activities.mobility[activity.activity].scores[activity.selection_key].score }}</td>
                </tr>
                {% endfor %}
              {% else %}
                <tr class="govuk-table__row">
                  <td class="govuk-table__cell align--top" colspan="3">
                    {{ content.en.tribunalView.mobilityActivitiesHeaderEmpty }}
                  </td>
                </tr>
              {% endif %}
              </tbody>
            </table>
          </div>
        </details>
      </div>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div>

      <h2 class="govuk-heading-m">{{ content.en.tribunalView.acceptHeader }}</h2>
      <p>{{ content.en.tribunalView.whatNextPara }}</p>

      <form action="/tribunal-view" method="post">
        {{ govukRadios({
            classes: "govuk-radios",
            idPrefix: "accept-view",
            name: "accept-view",
            items: [
              {
                value: "yes",
                text: content.en.tribunalView.acceptYes
              },
              {
                value: "no",
                text: content.en.tribunalView.acceptNo
              }
            ],
            errorMessage: {
              text: error
            } if error
          })
        }}
        <p>{{ content.en.tribunalView.acceptRespondBy | eval | date }}</p>
        {% include "includes/csrf-hidden-input.html" %}
        <div id="submit-button">
          {{
            govukButton({
            text: content.en.tribunalView.submitResponse
            })
          }}
        </div>
      </form>
    </div>
  </div>
  </div>

{% endblock %}
